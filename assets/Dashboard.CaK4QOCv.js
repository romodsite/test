import{r as e,j as t}from"./index.BAl22FBm.js";import{U as s,j as a,m as r,n as l,o as n,y as i,L as d,p as o}from"./App.R-CNmUno.js";import{C as c}from"./Card.hYBvXyrG.js";import"./vendor.BHl_RpiB.js";const x=()=>{const[x,p]=e.useState([]),[g,m]=e.useState([]),[h,u]=e.useState([]),[j,b]=e.useState([]),[w,y]=e.useState({page:1,totalPages:1,totalReports:0,limit:10}),[f,N]=e.useState(!0),{user:v}=e.useContext(s),[k,S]=e.useState((()=>localStorage.getItem("dashboardActiveTab")||"accepted"));e.useEffect((()=>{v&&P(k)}),[v,k]);const P=async e=>{N(!0);try{let t;"accepted"===e?(t=await a(10,null,v.username),p(t)):"pending"===e?(t=await r(v.username),m(t)):"rejected"===e?(t=await l(v.username),u(t)):"reported"===e&&(t=await n(w.page),t&&t.reports&&(b(t.reports),y({page:t.pagination.page,totalPages:t.pagination.totalPages,totalReports:t.pagination.totalReports,limit:t.pagination.limit||10})))}catch(t){i.error(t.message||"Error loading posts.")}finally{N(!1)}},C=e=>{S(e),localStorage.setItem("dashboardActiveTab",e),("accepted"===e&&0===x.length||"pending"===e&&0===g.length||"rejected"===e&&0===h.length||"reported"===e&&0===j.length)&&P(e)},R=e=>{1>e||e>w.totalPages||(y((t=>({...t,page:e}))),D(e))},D=async e=>{N(!0);try{const t=await n(e);t&&t.reports&&(b(t.reports),y({page:t.pagination.page,totalPages:t.pagination.totalPages,totalReports:t.pagination.totalReports,limit:t.pagination.limit||10}))}catch(t){i.error(t.message||"Error loading reported posts.")}finally{N(!1)}};return t.jsxs("div",{className:"container mx-auto p-4 pt-[100px] flex flex-col lg:flex-row",children:[t.jsxs("div",{className:"lg:fixed flex flex-col justify-between text-white mb-6 lg:w-1/4",children:[t.jsxs("div",{className:"flex flex-col items-center lg:items-start gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:(null==v?void 0:v.pfp)?null==v?void 0:v.pfp:"https://i.pinimg.com/736x/e8/3c/db/e83cdbd70190f7f28de6d68c9e129dd7.jpg",alt:"Profile",className:"h-24 w-24 lg:h-30 lg:w-30 rounded-full"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-white",children:null==v?void 0:v.username}),t.jsx(d,{to:"/settings",className:"text-white text-xl",children:t.jsx(o,{})})]}),t.jsx("p",{className:"text-sm lg:text-lg font-medium text-gray-400",children:null==v?void 0:v.role})]})]}),(null==v?void 0:v.banned)?t.jsx("div",{className:" w-fit mt-6 bg-gray-500 text-center text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Create new post"}):t.jsx(d,{to:"/dashboard/create-post",className:" w-fit mt-6 bg-blue-500 text-center text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Create new post"})]}),t.jsxs("p",{className:"font-bold mt-4 text-center lg:text-left",children:["Registration date ",t.jsx("br",{})," ",t.jsx("span",{className:"font-medium text-gray-400",children:(null==v?void 0:v.dateCreation)?v.dateCreation:"N/A"})]}),t.jsxs("p",{className:"font-bold mt-4 text-center lg:text-left",children:["Account status ",t.jsx("br",{})," ",(null==v?void 0:v.banned)?t.jsx("span",{className:"text-red-600 font-medium",children:"Suspended"}):t.jsx("span",{className:"text-green-600 font-medium",children:"Active"})]})]}),t.jsxs("div",{className:"lg:pl-[384px] w-full",children:[t.jsxs("div",{className:"flex flex-wrap gap-4 text-white mb-4 justify-center lg:justify-start",children:[t.jsx("button",{onClick:()=>C("accepted"),className:"accepted"===k?"w-32 lg:w-40 border-2 py-2 bg-white text-black rounded block z-10":"w-32 lg:w-40 border-2 py-2 rounded cursor-pointer block z-10",children:"Accepted"}),t.jsx("button",{onClick:()=>C("pending"),className:"pending"===k?"w-32 lg:w-40 border-2 py-2 bg-white text-black rounded block z-10":"w-32 lg:w-40 border-2 py-2 rounded cursor-pointer block z-10",children:"Pending"}),t.jsx("button",{onClick:()=>C("rejected"),className:"rejected"===k?"w-32 lg:w-40 border-2 py-2 bg-white text-black rounded block z-10":"w-32 lg:w-40 border-2 py-2 rounded cursor-pointer block z-10",children:"Rejected"}),t.jsx("button",{onClick:()=>C("reported"),className:"reported"===k?"w-32 lg:w-40 border-2 py-2 bg-white text-black rounded block z-10":"w-32 lg:w-40 border-2 py-2 rounded cursor-pointer block z-10",children:"Reported"})]}),f?t.jsx("p",{className:"text-white text-center",children:"Loading..."}):t.jsxs("div",{children:["accepted"===k&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl lg:text-3xl font-bold mb-4 text-white text-center lg:text-left",children:"Your posts"}),t.jsx("div",{className:"flex flex-wrap gap-4 justify-center lg:justify-start",children:0===x.length?t.jsx("p",{className:"text-white",children:"You don't have any approved posts yet."}):x.map((e=>t.jsx(c,{id:e.id,image:e.image,link:e.link,title:e.title,genres:e.genres||[],username:e.username,user:v},e.id)))})]}),"pending"===k&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl lg:text-3xl font-bold mb-4 text-white text-center lg:text-left",children:"Posts being reviewed"}),t.jsx("div",{className:"flex flex-wrap gap-4 justify-center lg:justify-start",children:0===g.length?t.jsx("p",{className:"text-white",children:"You don't have any posts awaiting moderation."}):g.map((e=>t.jsx(c,{image:e.image,link:e.link,title:e.title,genres:e.genres||[],username:e.username,user:v,isPending:!0},e.id)))})]}),"rejected"===k&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl lg:text-3xl font-bold mb-4 text-white text-center lg:text-left",children:"Rejected posts"}),t.jsx("div",{className:"flex flex-wrap gap-4 justify-center lg:justify-start",children:0===h.length?t.jsx("p",{className:"text-white",children:"You don't have any rejected posts."}):h.map((e=>t.jsx(c,{image:e.image,link:e.link,title:e.title,genres:e.genres||[],username:e.username,user:v,isRejected:!0,reason:e.reason},e.id)))})]}),"reported"===k&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl lg:text-3xl font-bold mb-4 text-white text-center lg:text-left",children:"Reported posts"}),0===j.length?t.jsx("p",{className:"text-white",children:"You haven't reported any posts."}):t.jsxs("div",{className:"overflow-x-auto",children:[t.jsx("div",{className:"block md:hidden",children:j.map((e=>t.jsxs("div",{className:"bg-gray-800 p-4 mb-4 rounded-lg text-white",children:[t.jsx("h3",{className:"font-bold text-lg border-b border-gray-700 pb-2 mb-2",children:e.postTitle||"Deleted post"}),t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-gray-400",children:"Posted by:"}),e.postOwnerUsername?t.jsx(d,{to:"/search?u="+e.postOwnerUsername,className:"text-blue-400 hover:underline",children:e.postOwnerUsername}):t.jsx("span",{className:"text-white",children:"Unknown user"})]}),t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-gray-400",children:"Reason:"}),"pending"!==e.reportStatus&&e.reason?t.jsx("span",{className:"text-white",children:e.reason}):t.jsx("span",{className:"text-gray-500",children:"-"})]}),t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-gray-400",children:"Date:"}),t.jsx("span",{className:"text-white",children:new Date(e.reportDate||e.date_creation).toLocaleDateString()})]}),t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-gray-400",children:"Status:"}),t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium\n                                                            "+("pending"===e.reportStatus?"bg-yellow-500 text-white":"accepted"===e.reportStatus?"bg-green-500 text-white":"rejected"===e.reportStatus?"bg-red-500 text-white":"bg-gray-500 text-white"),children:"pending"===e.reportStatus?"Pending":"accepted"===e.reportStatus?"Kept":"rejected"===e.reportStatus?"Deleted":e.reportStatus||"Unknown"})]})]},e.userReportId||e.id)))}),t.jsxs("table",{className:"w-full text-white hidden md:table",children:[t.jsx("thead",{className:"bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left",children:"Title"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"Posted by"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"Moderator reason"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"Date"}),t.jsx("th",{className:"px-4 py-3 text-center",children:"Status"})]})}),t.jsx("tbody",{children:j.map((e=>t.jsxs("tr",{className:"border-b border-gray-700",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{children:e.postTitle||"Deleted post"})}),t.jsx("td",{className:"px-4 py-3",children:e.postOwnerUsername?t.jsx(d,{to:"/search?u="+e.postOwnerUsername,className:"text-blue-400 hover:underline",children:e.postOwnerUsername}):t.jsx("span",{className:"text-gray-400",children:"Unknown user"})}),t.jsx("td",{className:"px-4 py-3 max-w-xs",children:"pending"!==e.reportStatus&&e.reason?t.jsx("p",{children:e.reason}):t.jsx("p",{className:"text-gray-500",children:"-"})}),t.jsx("td",{className:"px-4 py-3",children:new Date(e.reportDate||e.date_creation).toLocaleDateString()}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium\n                                                                "+("pending"===e.reportStatus?"bg-yellow-500 text-white":"accepted"===e.reportStatus?"bg-green-500 text-white":"rejected"===e.reportStatus?"bg-red-500 text-white":"bg-gray-500 text-white"),children:"pending"===e.reportStatus?"Pending":"accepted"===e.reportStatus?"Kept":"rejected"===e.reportStatus?"Deleted":e.reportStatus||"Unknown"})})]},e.userReportId||e.id)))})]}),w.totalPages>1&&t.jsx("div",{className:"flex justify-center mt-6",children:t.jsxs("nav",{className:"flex flex-wrap items-center justify-center",children:[t.jsx("button",{onClick:()=>R(w.page-1),className:"px-3 py-1 m-1 rounded-l border border-gray-700 "+(1===w.page?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-600"),disabled:1===w.page,children:"Previous"}),t.jsx("div",{className:"flex flex-wrap justify-center",children:[...Array(w.totalPages).keys()].map((e=>{const s=e+1;return 1===s||s===w.totalPages||s>=w.page-1&&s<=w.page+1?t.jsx("button",{onClick:()=>R(s),className:"px-3 py-1 border-t border-b border-gray-700 "+(w.page===s?"bg-blue-600 text-white":"bg-gray-700 text-white hover:bg-gray-600"),children:s},s):2===s&&w.page>3||s===w.totalPages-1&&w.page<w.totalPages-2?t.jsx("span",{className:"px-3 py-1 border-t border-b border-gray-700 bg-gray-700 text-white",children:"..."},s):null}))}),t.jsx("button",{onClick:()=>R(w.page+1),className:"px-3 py-1 m-1 rounded-r border border-gray-700 "+(w.page===w.totalPages?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gray-700 text-white hover:bg-gray-600"),disabled:w.page===w.totalPages,children:"Next"})]})}),t.jsx("p",{className:"text-gray-400 text-sm mt-4 text-center md:text-left",children:"Note: If you're not satisfied with the decision on a post that is no longer pending, you can report it again by finding it on the site."})]})]})]})]})]})};export{x as default};
