import{r as s,j as t}from"./index.Wwhnnbzn.js";import{U as E,k as L,F as B,j as D,y as R}from"./App.BzZBw0BN.js";import{C as T}from"./Card.DGkPx03n.js";import"./vendor.g9V5BtTL.js";const I=["","Exclusif","Community","Meme","Amateur","Asian","BDSM","Big Ass","Big Tits","Blonde","Brunette","Creampie","Ebony","Hardcore","Interracial","Latina","MILF","POV","Public","Redhead","Teen","Threesome"],M=()=>{const{user:v}=s.useContext(E),[r,N]=L(),[c,o]=s.useState([]),[x,h]=s.useState(!1),[p,g]=s.useState(null),[S,A]=s.useState(!1),[l,f]=s.useState(r.get("q")||""),[u,y]=s.useState(r.get("g")||""),[d,w]=s.useState(r.get("u")||""),[m,q]=s.useState(null),[P,C]=s.useState(window.innerWidth<640);s.useEffect(()=>{const e=()=>{C(window.innerWidth<640)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const j=async(e=null)=>{const a=(e==null?void 0:e.query)??l,i=(e==null?void 0:e.genre)??u,b=(e==null?void 0:e.username)??d;h(!0),g(null);try{A(!a&&!i&&!b);const n=await D(20,a,b,i,null);q({timestamp:new Date().toLocaleTimeString(),count:Array.isArray(n)?n.length:"non-array",firstItem:Array.isArray(n)&&n.length>0?n[0].title:"aucun"}),o(Array.isArray(n)?n:[])}catch(n){g(n.message||"Une erreur est survenue"),R.error("Erreur de recherche: "+(n.message||"Une erreur inconnue s'est produite")),o([])}finally{h(!1)}};return s.useEffect(()=>{const e=r.get("q"),a=r.get("g"),i=r.get("u");j(e||a||i?{query:e||"",genre:a||"",username:i||""}:{query:"",genre:"",username:""})},[]),s.useEffect(()=>{f(r.get("q")||""),y(r.get("g")||""),w(r.get("u")||"")},[r]),t.jsxs("div",{className:"p-8 pt-[100px]",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4 text-white",children:r.get("q")?`Résultats pour "${r.get("q")}"`:r.get("u")?`Posts de ${r.get("u")}`:r.get("g")?`Genre: ${r.get("g")}`:S?"Derniers posts publiés":"Recherche"}),t.jsx("form",{onSubmit:e=>{e.preventDefault();const a={};l&&(a.q=l),u&&(a.g=u),d&&(a.u=d),N(a),j()},className:"mb-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"relative flex-grow",children:[t.jsx("input",{type:"text",placeholder:"Rechercher...",value:l,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 rounded bg-gray-800 text-white focus:ring-2 focus:ring-blue-500"}),t.jsx(B,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:w-auto w-full",children:[t.jsxs("select",{value:u,onChange:e=>y(e.target.value),className:"px-4 py-3 rounded bg-gray-800 text-white md:w-40 w-full appearance-none cursor-pointer",children:[t.jsx("option",{value:"",children:"Tous les genres"}),I.filter(e=>e!=="").map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsx("input",{type:"text",placeholder:"Utilisateur",value:d,onChange:e=>w(e.target.value),className:"px-4 py-3 rounded bg-gray-800 text-white md:w-40 w-full"}),t.jsx("button",{type:"submit",className:"px-6 py-3 rounded bg-blue-600 text-white hover:bg-blue-700 transition w-full md:w-auto",children:"Rechercher"})]})]})}),p&&t.jsx("div",{className:"my-4 p-4 bg-red-500 bg-opacity-20 border-l-4 border-red-500 text-white rounded",children:p}),x&&t.jsxs("div",{className:"flex items-center justify-center my-20",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-red-500"}),t.jsx("span",{className:"ml-3 text-white text-lg",children:"Chargement..."})]}),!x&&t.jsx(t.Fragment,{children:c.length===0?t.jsxs("div",{className:"text-center text-white my-20",children:[t.jsx("p",{className:"text-xl font-medium",children:"Aucun résultat trouvé"}),t.jsx("p",{className:"text-gray-400 mt-2",children:"Essayez avec des termes de recherche différents"})]}):t.jsx("div",{className:"flex flex-wrap gap-2 sm:gap-4 justify-center lg:justify-start",children:c.map(e=>t.jsx(T,{id:e.id,image:e.image,link:e.link,title:e.title,genres:e.genres||[],username:e.username,user:v},e.id))})}),m&&t.jsxs("div",{className:"mt-8 text-xs text-gray-400",children:[t.jsxs("p",{children:["Dernière recherche: ",m.timestamp]}),t.jsxs("p",{children:["Nombre de résultats: ",m.count]}),t.jsxs("p",{children:["Premier résultat: ",m.firstItem]})]}),t.jsx("style",{children:`
                /* Sur mobile, réduire la taille des cartes */
                @media (max-width: 640px) {
                    .card {
                        width: 150px !important;
                        height: 230px !important;
                        min-width: 150px !important;
                        min-height: 230px !important;
                    }
                }
                
                /* Sur tablette, taille intermédiaire */
                @media (min-width: 641px) and (max-width: 768px) {
                    .card {
                        width: 190px !important;
                        height: 260px !important;
                        min-width: 190px !important;
                        min-height: 260px !important;
                    }
                }
                
                /* Le style par défaut utilise les dimensions standards du composant Card */
            `})]})};export{M as default};
