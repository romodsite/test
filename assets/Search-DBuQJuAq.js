import{r,j as t}from"./index-D8fr86l7.js";import{U as L,j as U,k as D,g as I,y as M}from"./App-C8aaqOOE.js";import{C as B}from"./Card-L7GoYhtm.js";const z=["","Exclusif","Community","Meme","Amateur","Asian","BDSM","Big Ass","Big Tits","Blonde","Brunette","Creampie","Ebony","Hardcore","Interracial","Latina","MILF","POV","Public","Redhead","Teen","Threesome"],Q=()=>{const{user:N}=r.useContext(L),[s,E]=U(),[h,x]=r.useState([]),[p,f]=r.useState(!1),[y,w]=r.useState(null),[P,b]=r.useState(!1),[l,j]=r.useState(s.get("q")||""),[o,v]=r.useState(s.get("g")||""),[u,S]=r.useState(s.get("u")||""),[c,q]=r.useState(null),[G,R]=r.useState(window.innerWidth<640);r.useEffect(()=>{const e=()=>{R(window.innerWidth<640)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const m=async(e=null)=>{const a=(e==null?void 0:e.query)??l,i=(e==null?void 0:e.genre)??o,g=(e==null?void 0:e.username)??u;f(!0),w(null);try{!a&&!i&&!g?(console.log("Affichage des derniers posts publiés"),b(!0)):(console.log("Recherche avec termes:",{query:a,genre:i,username:g}),b(!1));const n=await I(20,a,g,i,null);console.log("Résultats reçus:",n),q({timestamp:new Date().toLocaleTimeString(),count:Array.isArray(n)?n.length:"non-array",firstItem:Array.isArray(n)&&n.length>0?n[0].title:"aucun"}),x(Array.isArray(n)?n:[])}catch(d){console.error("Erreur lors de la recherche:",d),w(d.message||"Une erreur est survenue"),M.error("Erreur de recherche: "+(d.message||"Une erreur inconnue s'est produite")),x([])}finally{f(!1)}};r.useEffect(()=>{const e=s.get("q"),a=s.get("g"),i=s.get("u");e||a||i?(console.log("Paramètres détectés dans l'URL, recherche initiale"),m({query:e||"",genre:a||"",username:i||""})):(console.log("Pas de paramètres dans l'URL, affichage des derniers posts"),m({query:"",genre:"",username:""}))},[]),r.useEffect(()=>{j(s.get("q")||""),v(s.get("g")||""),S(s.get("u")||"")},[s]);const A=e=>{e.preventDefault();const a={};l&&(a.q=l),o&&(a.g=o),u&&(a.u=u),console.log("Mise à jour des paramètres de recherche:",a),E(a),m()},C=()=>s.get("q")?`Résultats pour "${s.get("q")}"`:s.get("u")?`Posts de ${s.get("u")}`:s.get("g")?`Genre: ${s.get("g")}`:P?"Derniers posts publiés":"Recherche";return t.jsxs("div",{className:"p-8 pt-[100px]",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4 text-white",children:C()}),t.jsx("form",{onSubmit:A,className:"mb-6",children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"relative flex-grow",children:[t.jsx("input",{type:"text",placeholder:"Rechercher...",value:l,onChange:e=>j(e.target.value),className:"w-full px-4 py-3 rounded bg-gray-800 text-white focus:ring-2 focus:ring-blue-500"}),t.jsx(D,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:w-auto w-full",children:[t.jsxs("select",{value:o,onChange:e=>v(e.target.value),className:"px-4 py-3 rounded bg-gray-800 text-white md:w-40 w-full appearance-none cursor-pointer",children:[t.jsx("option",{value:"",children:"Tous les genres"}),z.filter(e=>e!=="").map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsx("input",{type:"text",placeholder:"Utilisateur",value:u,onChange:e=>S(e.target.value),className:"px-4 py-3 rounded bg-gray-800 text-white md:w-40 w-full"}),t.jsx("button",{type:"submit",className:"px-6 py-3 rounded bg-blue-600 text-white hover:bg-blue-700 transition w-full md:w-auto",children:"Rechercher"})]})]})}),y&&t.jsx("div",{className:"my-4 p-4 bg-red-500 bg-opacity-20 border-l-4 border-red-500 text-white rounded",children:y}),p&&t.jsxs("div",{className:"flex items-center justify-center my-20",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-red-500"}),t.jsx("span",{className:"ml-3 text-white text-lg",children:"Chargement..."})]}),!p&&t.jsx(t.Fragment,{children:h.length===0?t.jsxs("div",{className:"text-center text-white my-20",children:[t.jsx("p",{className:"text-xl font-medium",children:"Aucun résultat trouvé"}),t.jsx("p",{className:"text-gray-400 mt-2",children:"Essayez avec des termes de recherche différents"})]}):t.jsx("div",{className:"flex flex-wrap gap-2 sm:gap-4 justify-center lg:justify-start",children:h.map(e=>t.jsx(B,{id:e.id,image:e.image,link:e.link,title:e.title,genres:e.genres||[],username:e.username,user:N},e.id))})}),c&&t.jsxs("div",{className:"mt-8 text-xs text-gray-400",children:[t.jsxs("p",{children:["Dernière recherche: ",c.timestamp]}),t.jsxs("p",{children:["Nombre de résultats: ",c.count]}),t.jsxs("p",{children:["Premier résultat: ",c.firstItem]})]}),t.jsx("style",{children:`
                /* Sur mobile, réduire la taille des cartes */
                @media (max-width: 640px) {
                    .card {
                        width: 150px !important;
                        height: 230px !important;
                        min-width: 150px !important;
                        min-height: 230px !important;
                    }
                }
                
                /* Sur tablette, taille intermédiaire */
                @media (min-width: 641px) and (max-width: 768px) {
                    .card {
                        width: 190px !important;
                        height: 260px !important;
                        min-width: 190px !important;
                        min-height: 260px !important;
                    }
                }
                
                /* Le style par défaut utilise les dimensions standards du composant Card */
            `})]})};export{Q as default};
